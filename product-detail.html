<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Details - E-Shop</title>
    <!-- General styles for the entire site (includes dark mode logic) -->
    <link rel="stylesheet" href="css/style.css" />
    <!-- Specific styles for the product detail page -->
    <link rel="stylesheet" href="css/product-detail.css" />
    <!-- Bootstrap CSS CDN for responsive grid and basic components -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <!-- Font Awesome for icons (e.g., plus/minus for quantity) -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      xintegrity="sha512-..."
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <body>
    <!-- Header Section (consistent across site) -->
    <header class="site-header">
      <div class="container header-inner">
        <h1 class="logo">ðŸ›’ E-Shop</h1>
        <nav class="main-nav">
          <a href="index.html">Home</a>
          <a href="products.html">Products</a>
          <a href="cart.html">Cart</a>
          <!-- This link will dynamically change to "Logout" if logged in -->
          <a href="login.html" id="auth-link">Login</a>
        </nav>
        <!-- Theme Toggle Button -->
        <button id="theme-toggle" class="theme-button" title="Toggle Dark Mode">
          ðŸŒ“
        </button>
      </div>
    </header>

    <!-- Main Content - Product Details -->
    <main class="container my-5">
      <div id="product-detail-loading" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading product...</span>
        </div>
        <p class="mt-2 text-muted">Loading product details...</p>
      </div>

      <div
        id="product-not-found"
        class="text-center py-5"
        style="display: none"
      >
        <i class="fas fa-exclamation-triangle fa-5x text-warning mb-4"></i>
        <p class="lead">Product not found.</p>
        <p class="text-muted">
          The product you are looking for does not exist or has been removed.
        </p>
        <a href="products.html" class="btn btn-primary mt-3">
          <i class="fas fa-arrow-left me-2"></i>Back to Products
        </a>
      </div>

      <div
        id="product-detail-container"
        class="card shadow-lg p-lg-5 p-md-4 p-3"
        style="display: none"
      >
        <div id="product-message" class="alert" style="display: none"></div>
        <div class="row g-4">
          <!-- Product Image Gallery (Left Column) -->
          <div class="col-lg-6 col-md-12">
            <div class="product-image-main mb-3">
              <img
                id="product-image-main"
                src="https://placehold.co/600x400/007bff/FFFFFF?text=Product+Image"
                alt="Product Image"
                class="img-fluid rounded"
                onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/000000?text=Image+Not+Available';"
              />
            </div>
            <!-- Optional: Thumbnail gallery if multiple images -->
            <!--
            <div class="product-thumbnails d-flex justify-content-center gap-2">
              <img src="https://placehold.co/100x70/007bff/FFFFFF?text=Thumb1" alt="Thumbnail 1" class="img-thumbnail rounded" />
              <img src="https://placehold.co/100x70/007bff/FFFFFF?text=Thumb2" alt="Thumbnail 2" class="img-thumbnail rounded" />
            </div>
            -->
          </div>

          <!-- Product Information & Actions (Right Column) -->
          <div class="col-lg-6 col-md-12 product-info-col">
            <h1 class="product-name" id="product-name">
              Product Name Loading...
            </h1>
            <p class="product-category text-muted mb-2">
              Category: <span id="product-category"></span>
            </p>
            <p
              class="product-price display-4 fw-bold text-primary mb-4"
              id="product-price"
            >
              $0.00
            </p>

            <p class="product-description lead mb-4" id="product-description">
              Loading description...
            </p>

            <div class="product-stock-status mb-4">
              <p>
                <i class="fas fa-boxes me-2"></i>In Stock:
                <span id="product-stock">0</span> units
              </p>
            </div>

            <!-- Quantity Selector -->
            <div class="quantity-selector d-flex align-items-center mb-4">
              <label for="quantity-input" class="form-label me-3 mb-0"
                >Quantity:</label
              >
              <div class="input-group" style="width: 150px">
                <button
                  class="btn btn-outline-secondary"
                  type="button"
                  id="quantity-minus-btn"
                >
                  <i class="fas fa-minus"></i>
                </button>
                <input
                  type="number"
                  class="form-control text-center"
                  id="quantity-input"
                  value="1"
                  min="1"
                  aria-label="Product Quantity"
                />
                <button
                  class="btn btn-outline-secondary"
                  type="button"
                  id="quantity-plus-btn"
                >
                  <i class="fas fa-plus"></i>
                </button>
              </div>
            </div>

            <!-- Add to Cart Button -->
            <button
              id="add-to-cart-btn"
              class="btn btn-success btn-lg w-100 py-3 mb-3"
            >
              <i class="fas fa-cart-plus me-2"></i>Add to Cart
            </button>

            <!-- Other actions like "Add to Wishlist" -->
            <button class="btn btn-outline-primary w-100">
              <i class="fas fa-heart me-2"></i>Add to Wishlist
            </button>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer Section (consistent across site) -->
    <footer class="bg-dark text-white text-center py-4">
      <div class="container">
        <p>&copy; 2024 E-Shop. All rights reserved.</p>
        <div class="social-links mt-3">
          <a href="#" class="text-white mx-2"
            ><i class="fab fa-facebook-f"></i
          ></a>
          <a href="#" class="text-white mx-2"><i class="fab fa-twitter"></i></a>
          <a href="#" class="text-white mx-2"
            ><i class="fab fa-instagram"></i
          ></a>
        </div>
      </div>
    </footer>

    <!-- Bootstrap JS Bundle (includes Popper.js) -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      xintegrity="sha384-..."
      crossorigin="anonymous"
    ></script>
    <!-- Custom site-wide JavaScript (e.g., theme toggle, common header logic) -->
    <script src="js/main.js"></script>
    <!-- Page-specific JavaScript for product detail logic -->
    <script src="js/product-detail.js"></script>
    <!-- Inline script for dynamic login/logout link on this page -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const authLink = document.getElementById("auth-link");

        // Function to update auth link status
        const updateAuthLink = () => {
          const token = localStorage.getItem("jwt_token"); // Check for JWT
          if (token) {
            authLink.textContent = "Logout";
            authLink.href = "#"; // Make logout link non-navigable directly

            // Attach logout listener
            authLink.addEventListener("click", (e) => {
              e.preventDefault();
              localStorage.removeItem("jwt_token"); // Clear token
              alert("You have been logged out."); // Simple alert
              window.location.reload(); // Reloads page to reflect change
            });
          } else {
            authLink.textContent = "Login";
            authLink.href = "login.html";
            // Ensure any old logout listener is removed if the state changes
            const oldListener = authLink._logoutListener; // Check if listener was stored
            if (oldListener) {
              authLink.removeEventListener("click", oldListener);
              authLink._logoutListener = null;
            }
          }
        };

        updateAuthLink(); // Call on page load
      });
    </script>
  </body>
</html>
